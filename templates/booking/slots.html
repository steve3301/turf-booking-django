{% extends "booking/base.html" %}
{% load static %}
{% block content %}

<div class="slots-wrapper">

  <div class="slots-top">
    <h1>{{ sport.name }}</h1>
    <p>Choose your time. Lock your game.</p>
  </div>

  <!-- DATE STRIP -->
  <div class="date-strip">
    {% for d in dates %}
      <a href="?date={{ d|date:'Y-m-d' }}"
         class="date-box {% if d == selected_date %}active{% endif %}">
        <small>{{ d|date:"D" }}</small>
        <span>{{ d|date:"d" }}</span>
      </a>
    {% endfor %}
  </div>

  <!-- SLOT GRID -->
  <div class="slots-grid">

    {% for slot in slots %}
      {% if slot.is_booked %}
        <div class="slot booked">
          <h4>{{ slot.start_label }} – {{ slot.end_label }}</h4>
          <span>Booked</span>
        </div>

      {% elif slot.time.hour < current_hour and selected_date == today %}
        <div class="slot expired">
          <h4>{{ slot.start_label }} – {{ slot.end_label }}</h4>
          <span>Expired</span>
        </div>

      {% else %}
        <div class="slot available"
             data-id="{{ slot.id }}"
             data-price="{{ slot.price }}">
          <h4>{{ slot.start_label }} – {{ slot.end_label }}</h4>
          <span>₹{{ slot.price }}</span>
        </div>
      {% endif %}
    {% endfor %}

  </div>
</div>

<!-- BOOKING BAR -->
<div class="booking-bar" id="bookingBar" style="display:none;">
  <span id="bookingText">0 slot selected</span>

  <form method="POST" action="{% url 'user_details' %}">
    {% csrf_token %}
    <input type="hidden" name="slots[]" id="selectedSlots">
    <button type="submit">Proceed to Payment</button>
  </form>
</div>

<script src="{% static 'booking/js/slots.js' %}"></script>

{% endblock %}
